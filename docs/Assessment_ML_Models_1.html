<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Andreas Handel" />


<title>Assessment - Machine Learning Models 1</title>

<script src="site_libs/header-attrs-2.24/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
<link href="site_libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
<script src="site_libs/bs3compat-0.5.1/transition.js"></script>
<script src="site_libs/bs3compat-0.5.1/tabs.js"></script>
<script src="site_libs/bs3compat-0.5.1/bs3compat.js"></script>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />
<link rel="icon" type="image/png" href="media/MADAlogo.png" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">MADA Course</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    General Information
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./Course_Syllabus.html">Syllabus</a>
    </li>
    <li>
      <a href="./Course_Schedule.html">Schedule</a>
    </li>
    <li>
      <a href="./Course_Communication.html">Communication</a>
    </li>
    <li>
      <a href="./Course_Assessments.html">Assessments</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Modules
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">1. Course and Tools Introduction</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./Introduction_Course.html">Course Introduction</a>
        </li>
        <li>
          <a href="./Tools_RandRStudio.html">R and Rstudio</a>
        </li>
        <li>
          <a href="./Tools_Github_Introduction.html">GitHub Introduction</a>
        </li>
        <li>
          <a href="./Tools_Github_R_Workflow.html">GitHub and R Workflow</a>
        </li>
        <li>
          <a href="./Tools_Reproducibility.html">Reproducibility, Quarto &amp; Co</a>
        </li>
        <li>
          <a href="./Tools_AI.html">AI Tools</a>
        </li>
        <li>
          <a href="./Tools_Reference_Management.html">Reference Management</a>
        </li>
        <li>
          <a href="./Tools_Tips_Guidance.html">Guidance and Tips for R/RStudio/GitHub</a>
        </li>
        <li>
          <a href="./Assessment_Course_Tools_Introduction.html">Assessment: Course and Tools Introduction</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">2. Data Analysis Introduction</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./Data_Analysis_Motivation.html">Motivating Examples</a>
        </li>
        <li>
          <a href="./Data_Analysis_Overview.html">Data Analysis Overview</a>
        </li>
        <li>
          <a href="./Data_Analysis_Structure.html">Data Analysis Structure</a>
        </li>
        <li>
          <a href="./Assessment_Data_Analysis.html">Assessment: Data Analysis Introduction</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">3. R Coding Basics</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./Rcoding_Basics.html">R Coding Basics</a>
        </li>
        <li>
          <a href="./Rcoding_Tidyverse.html">Tidyverse and Friends</a>
        </li>
        <li>
          <a href="./Assessment_Coding.html">Assessment: R Coding Basics</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">4. Contemplating, finding and wrangling data</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./Data_Types.html">Data Types</a>
        </li>
        <li>
          <a href="./Data_Finding.html">Finding Data</a>
        </li>
        <li>
          <a href="./Data_Generation.html">Making Data</a>
        </li>
        <li>
          <a href="./Data_Wrangling.html">Data wrangling</a>
        </li>
        <li>
          <a href="./Assessment_Data_Finding_Wrangling.html">Assessment: Data Finding and Wrangling</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">5. Presenting data and results</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./Presenting_Results_Overview.html">Presenting Results Overview</a>
        </li>
        <li>
          <a href="./Visualization_Overview.html">Visualization Overview</a>
        </li>
        <li>
          <a href="./Visualization_in_R.html">Visualization in R</a>
        </li>
        <li>
          <a href="./Tables_in_R.html">Tables in R</a>
        </li>
        <li>
          <a href="./Assessment_Presenting_Results.html">Assessment: Presenting Results</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">6. Data Exploration</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./Data_Exploration.html">Exploring data</a>
        </li>
        <li>
          <a href="./Assessment_Exploration.html">Assessment: Exploration</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">7. Statistical analysis overview</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./Statistical_Analysis_Introduction.html">Statistical analysis introduction</a>
        </li>
        <li>
          <a href="./Statistical_Terminology.html">Some Statistical Model Fitting Terminology</a>
        </li>
        <li>
          <a href="./Assessment_Statistical_Analysis.html">Assessment: Statistical Analysis Overview</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">8. Fitting basic statistical models</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./Basic_Statistical_Models.html">Basic statistical models</a>
        </li>
        <li>
          <a href="./Model_Fitting_R.html">Fitting statistical models in R</a>
        </li>
        <li>
          <a href="./Assessment_Fitting_Basic_Models.html">Assessment: Fitting Basic Models</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">9. Evaluating your model fits</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./Model_Evaluation_Overview.html">Model evaluation overview</a>
        </li>
        <li>
          <a href="./Model_Evaluation_Performance.html">Model performance evaluation</a>
        </li>
        <li>
          <a href="./Model_Evaluation_Overfitting.html">Model performance &amp; overfitting</a>
        </li>
        <li>
          <a href="./Model_Evaluation_Diagnostics.html">Model Diagostics</a>
        </li>
        <li>
          <a href="./Model_Evaluation_Uncertainty.html">Model Uncertainty</a>
        </li>
        <li>
          <a href="./Assessment_Model_Evaluation.html">Assessment: Model evaluation</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">10. Improving your model fits</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./Model_Improvement_Overview.html">Improving model fits overview</a>
        </li>
        <li>
          <a href="./Model_Improvement_Data_Processing.html">Pre-processing data</a>
        </li>
        <li>
          <a href="./Model_Improvement_Subset_Selection.html">Subset selection</a>
        </li>
        <li>
          <a href="./Model_Improvement_Regularization.html">Regularization</a>
        </li>
        <li>
          <a href="./Model_Improvement_Tuning.html">Model tuning</a>
        </li>
        <li>
          <a href="./Assessment_Model_Improvement.html">Assessment: Model Improvement</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">11. Machine Learning Models I</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./ML_Models_Overview.html">ML Models overview</a>
        </li>
        <li>
          <a href="./Polynomial_Spline_Models.html">Polynomial and Spline Models</a>
        </li>
        <li>
          <a href="./Decision_Trees.html">Decision Trees</a>
        </li>
        <li>
          <a href="./Many_Tree_Models.html">Many-tree models</a>
        </li>
        <li>
          <a href="./Assessment_ML_Models_1.html">Assessment: ML models 1</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">12. Machine Learning Models II</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./SVM_Models.html">Support Vector Machine Models</a>
        </li>
        <li>
          <a href="./DA_Models.html">Discriminant Analysis Models</a>
        </li>
        <li>
          <a href="./More_ML_Models.html">Some more ML models</a>
        </li>
        <li>
          <a href="./Assessment_ML_Models_2.html">Assessment: ML models 2</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">13. The complete analysis workflow</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./Complete_data_analysis_workflow.html">Complete data analysis workflow</a>
        </li>
        <li>
          <a href="./Data_Models_Not_Covered.html">More Data and Models</a>
        </li>
        <li>
          <a href="./Open_Science.html">Open Science</a>
        </li>
        <li>
          <a href="./Assessment_Complete_Workflow.html">Assessment: Complete Analysis Workflow</a>
        </li>
      </ul>
    </li>
    <li class="dropdown-submenu">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">14. Deep learning, AI and Big data</a>
      <ul class="dropdown-menu" role="menu">
        <li>
          <a href="./DL_AI_BigData.html">Deep Learning, AI and Big Data</a>
        </li>
      </ul>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Project
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./Project_Overview.html">Project Overview</a>
    </li>
    <li>
      <a href="./Project_Details.html">Project Details</a>
    </li>
    <li>
      <a href="./Project_Review.html">Project Review</a>
    </li>
    <li>
      <a href="./Project_Examples.html">Project Examples</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Resources
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="./Course_Resources.html">Course Resources</a>
    </li>
    <li>
      <a href="./General_Resources.html">General Resources</a>
    </li>
    <li>
      <a href="./Course_Glossary.html">Glossary</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/andreashandel/MADAcourse">
    <span class="fab fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Assessment - Machine Learning Models 1</h1>
<h4 class="author">Andreas Handel</h4>
<h4 class="date">2023-03-15 13:33:18.201414</h4>

</div>


<div id="quiz" class="section level1">
<h1>Quiz</h1>
<p>Get the quiz sheet for this module from the general <a
href="./Course_Assessments.html"><strong>Assessments</strong></a> page.
Fill it in, then submit to the online grading system before the
deadline.</p>
</div>
<div id="exercise" class="section level1">
<h1>Exercise</h1>
<p>For this exercise, we will implement some of the machine learning
models covered in this module, and some of the general approaches we
covered previously. This is a continuation of the
<code>Flu Analysis</code> exercise you’ve been working on over the last
few weeks. The goal is that by the end of this exercise, you will have
an example of a nice full analysis. So let’s get started!</p>
<p><strong>Note: This exercise is likely time-consuming and you might
get stuck. Please plan accordingly. Start early and ask for help in
Slack.</strong></p>
<div id="setup" class="section level2">
<h2>Setup</h2>
<p>This is a solo-exercise, and it’s part of your portfolio.</p>
<p>The goal is to have both a complete and well-organized data analysis
example at the end of the exercise. So as you go through this exercise,
in addition to doing the indicated tasks and writing the code, keep
organizing things as needed. You want to make sure you have readme files
or other documentation that briefly explain what files are where and in
which order to run them. Make sure your R/Quarto files are easy to
understand and that they all run.</p>
<p>As you re-organize, you can decide the mix of R and Quarto files and
what you want to combine and what to split. However you do it, make sure
it’s documented and easy to understand.</p>
</div>
<div id="pre-processing" class="section level2">
<h2>Pre-processing</h2>
<p>We previously covered pre-processing, but haven’t specifically looked
at that yet in an exercise. So let’s add that part. This can be added in
various places to the code/files you already created previously. You can
for instance make it part of the cleaning/wrangling code, or include it
in the <code>recipe</code> part of your <code>tidymodels</code> workflow
(or a mix).</p>
<div id="featurevariable-removal" class="section level3">
<h3>Feature/Variable removal</h3>
<p>You probably realized that some of the variables contain the same
information in slightly different ways. Specifically,
<code>Weakness</code>, <code>Cough</code> and <code>Myalgia</code> exist
on both a severity score and as Yes/No. Further, there are 2 variables
for cough yes/no. These variables are strongly correlated and thus at a
minimum, don’t help when you model, and are actually more likely to
confuse your model and lead to errors/warnings/poor model performance
(e.g. “predictions from a rank-deficient fit may be misleading). So
let’s fix that. For those symptoms where you have both multiple levels
and yes/no, remove all the yes/no versions. That should remove 4
variables.</p>
</div>
<div id="categoricalordinal-predictors" class="section level3">
<h3>Categorical/Ordinal predictors</h3>
<p>Some of your predictors are categorical (e.g., Yes/No) and the 3
symptom severity factors are ordinal, with None &lt; Mild &lt; Moderate
&lt; Severe.</p>
<p>We can code the categorical variables as <strong>unordered
factors</strong> and the others as <strong>ordered factors</strong>. I
want you to do that as practice. The functions <code>step_dummy()</code>
and <code>step_ordinalscore()</code> will help. See e.g. the help file
example for <code>step_ordinalscore()</code>. Not that to deal with
ordered factors in a statistical analysis, one needs special approaches
(and we won’t actually do those for this exercise.)</p>
</div>
<div id="low-near-zero-variance-predictors" class="section level3">
<h3>Low (“near-zero”) variance predictors</h3>
<p>If you look at your data, you’ll see that some predictors are fairly
<strong>unbalanced</strong>, with most patients reporting
<code>No</code> and only a few <code>Yes</code>. If almost everyone is
in one category and almost nobody in others, that often (but not always)
means those predictor variables are not very helpful in
fitting/predicting the outcome. Furthermore, if you do cross-validation
and one of your samples happen to not include one predictor level at
all, things might go wrong when applied to the holdout-sample. (There
are methods to deal with this specific problem, but they are more
complicated than what we will do here.) Thus, it is worth considering if
we want to remove them. The <code>recipes</code> package in
<code>tidymodels</code> has the function <code>step_nzv()</code> which
can do that for you automatically. If you have lots of predictors, that
might be good to use. But it’s often better to decide <em>manually</em>
for each variable based on your scientific expertise if you want to
remove it or not. We’ll take that approach here. After looking at the
data, we decide to remove those <strong>binary</strong> predictors that
have &lt;50 entries in one category (there are 2). Write code to remove
them.</p>
<p>You should end up with a data frame that has 730 observations and 26
variables. This is the dataset we’ll use for modeling.</p>
</div>
</div>
<div id="analysis-code" class="section level2">
<h2>Analysis code</h2>
<p>Start a new Quarto file for this analysis, call it
<code>machinelearing.qmd</code>, place it into the <code>code</code>
folder. Note that for this exercise, some of your code might take long
to run. This is one of the situations where it is often good to have a
setup where some of the heavy computations are done by separate R
scripts/functions, and the results saved, pulled into and displayed in
the Quarto file. How you want to do it here is up to you, as long as the
Quarto file shows all the main results and your code/file(s) are well
documented.</p>
<p>To keep things a bit simpler, for this exercise we focus on a single
outcome, the <strong>continuous, numerical</strong> value of
<strong>Body temperature</strong>. Thus, we are fitting
<strong>regression</strong> models here. Once you finished the whole
workflow for that outcome, you are welcome to (optionally) do it again
and run a <strong>classification</strong> for the
<strong>categorical</strong> outcome of <strong>Nausea</strong>. Since
we are doing a regression, and we don’t have any specific expert
knowledge that tells us how we should build our performance metric,
we’ll go with one of the usual ones, namely RMSE. But remember to always
think about your performance metric and don’t just use the default
without at least considering other options.</p>
<div id="data-setup" class="section level3">
<h3>Data Setup</h3>
<ul>
<li><p>Start by setting the random seed to <code>123</code>. This should
make everything reproducible and everyone should get the same
results.</p></li>
<li><p>Split the dataset into 70% training, 30% testing. Also use the
outcome <code>BodyTemp</code> as stratification. This allows for more
balanced outcome values in the train and test sets. See e.g., <a
href="https://www.tidymodels.org/start/resampling/">section 3 of the
<em>Get Started</em> tutorial</a>.</p></li>
<li><p>We want to do 5-fold cross-validation, 5 times repeated. (There’s
no specific reason to do this 5x5 pattern, other than to show you that
there are different ways to pick the sample, and that I want you to not
use the default.) For the CV folds, we also want to stratify on
<code>BodyTemp</code>, as we did for the main train/test split. Use the
<code>vfold_cv()</code> function to create a resample object for the
training data with these specifications.</p></li>
<li><p>Create a recipe for the data and fitting. You won’t need to do
much, just make sure you code the categorical variables as dummy
variables, otherwise things might not work smoothly. For that, you want
to use the <code>step_dummy()</code> function and pick all nominal
predictor variables (which are actually all predictor variables here,
since the only continuous variable is our outcome).</p></li>
</ul>
</div>
<div id="null-model-performance" class="section level3">
<h3>Null model performance</h3>
<p>Write some code to compute the performance of a null model, i.e. a
“model” that doesn’t use any predictor information. For a continuous
outcome and RMSE as our metric, a null model is one that always predicts
the mean of the outcome. Compute the RMSE for both training and test
data for such a “model”. We’ll use that later to compare it to the
performance of our real models. Of course, we expect/hope our real
models that use predictor information to be better. If they aren’t that
means they are no good.</p>
</div>
<div id="model-tuning-and-fitting" class="section level3">
<h3>Model tuning and fitting</h3>
<p>We’ll fit a tree, a LASSO model, and a random forest. I chose those
because they are used in the tutorial on the <code>tidymodels</code>
website. You can of course add further models. For the tree, see the
<em>Tune model parameters</em> section of the <a
href="https://www.tidymodels.org/start/tuning/"><em>Get Started</em>
tutorial</a>. For LASSO and the random forest, check out the <em>Case
Study</em> section of the <a
href="https://www.tidymodels.org/start/case-study/"><em>Get Started</em>
tutorial</a>. Note that you will need to adjust the code for our
scenario since we have a continuous outcome.</p>
<p>If you follow the tutorial, you’ll likely use the packages
<code>rpart</code>, <code>glmnet</code> and <code>ranger</code> to fit
those 3 models. Make sure they are installed and loaded.</p>
<p>I suggest you write code for each model separately. A lot of the code
will look similar, so once you got the first one set up, the other two
should be easier. They mainly differ in the commands specifying the
tuning parameters and the tuning grid.</p>
<p>Each of these models requires some tuning. For the choices regarding
the tuning parameters, you can follow the examples. Most of the models
have more things that can be tuned, but for now you can stick to what
they show in the tutorial. Follow the examples by setting up a workflow,
set a tuning grid, and then use the <code>tune_grid()</code> function to
tune the model using cross-validation.</p>
<p><strong>Note that the tuning part, i.e., calling
<code>tune_grid()</code> might take a good bit of time to run (possibly
minutes).</strong></p>
<p>The steps (block of code) you should have here are 1) model
specification, 2) workflow definition, 3) tuning grid specification and
4) tuning using cross-validation and the <code>tune_grid()</code>
function.</p>
</div>
<div id="model-evaluation" class="section level3">
<h3>Model evaluation</h3>
<p>Once you have done the tuning, you can take a look at some
diagnostics by sending your object returned from the
<code>tune_grid()</code> function to <code>autoplot()</code>. For
instance if you tuned the tree and saved the result as
<code>tree_tune_res</code>, you can run
<code>tree_tune_res %&gt;% autoplot()</code>. Depending on the model,
the plot will be different, but in general it shows you what happened
during the tuning process.</p>
<p>Next, you want to get the model that the tuning process has
determined is the best. You can get the best-fit model with
<code>select_best()</code> and <code>finalize_workflow()</code> and then
do one more fit to the <strong>training data</strong> with this final
workflow using the <code>fit()</code> function. Follow the examples in
the tutorial.</p>
<p>To evaluate the final fit for each model, do the following.</p>
<ol style="list-style-type: decimal">
<li><p>Make two plots, one that shows model predictions from the tuned
model versus actual outcomes, and one that plots residuals. The actual
outcomes you get straight from the data, the predicted outcomes you can
get by applying the <code>predict()</code> function to the final
fit.</p></li>
<li><p>Look at/print the model performance and compare it with the null
model (still only on training data). Here, we want the performance of
the tuned, best-fitting model on the CV dataset (we are not yet touching
the test data). You can get that for instance with the
<code>show_best()</code> function, which gives you the mean
cross-validated performance for the best models. It also shows the
standard deviation for the performance. Compare that model performance
with the null model.</p></li>
</ol>
<p>The mean and standard deviation of the performance give you a measure
of overall performance and variability in that measure. The plots show
you if there are any systematic deviations between model and data. Taken
together, these can be compared for the different models and based on
those (and as wanted, other considerations) a final model can be
chosen.</p>
<p><strong>Implement the model tuning/fitting and evaluating steps for
all 3 models.</strong></p>
</div>
<div id="comments-for-specific-models" class="section level3">
<h3>Comments for specific models</h3>
<p>Here are some more suggestions and hints. Most of this is optional
but worth trying.</p>
<p><strong>For the tree model</strong>, if you want to plot the tree,
you can use the <code>rpart.plot</code> package and run this command
<code>rpart.plot(extract_fit_parsnip(best_tree_fit)$fit)</code>
(assuming your result from the final workflow fit is called
<code>best_tree_fit</code>). You might get a warning message, but the
tree will show. You will likely find when you look at the
actual/predicted plot or the residual plot that the tree model does not
perform very well, and the model only predicts a few discrete outcome
values. That’s also noticeable when you compare RMSE for the tree model
and the null model, they are very similar.</p>
<p><strong>For the lasso model</strong>, you will likely find that it
performs a bit better than the tree, but not a lot. If you want to see a
plot for how the number of predictors included in the LASSO model
changes with the tuning parameter, you can extract the model from your
final fit (say it’s called <code>best_lasso_fit</code>) with
<code>x &lt;- best_lasso_fit$fit$fit$fit</code> and then
<code>plot(x, "lambda")</code>. I know, this is awful code having to dig
that deep into the <code>best_lasso_fit</code> object. You might also be
able to use the <code>extract_fit_engine()</code> function to get the
underlying fit object produced by LASSO, e.g.,
<code>x &lt;- extract_fit_engine(best_lasso_fit)</code> might work (this
is new in <code>tidymodels</code> and I haven’t fully tried it yet).</p>
<p><strong>For the random forest model</strong>, you will likely again
find that it performs a bit better than the tree, but not a lot. The
tuning setup might require some fiddling around, I had a few initial
tries where the whole tuning failed. For a model like random forest, all
variables stay in the model. There are ways to look at the variables
that are most important. If you want to do that, you again need to pull
out the fit object. Say it’s called <code>best_rf_fit</code>, you can do
that with <code>x &lt;- best_rf_fit$fit$fit$fit</code> and then use the
<code>vip()</code> function from the <code>vip</code> package to plot
the importance of the variables. Alternatively
<code>extract_fit_engine()</code> should also work.</p>
</div>
<div id="model-selection" class="section level3">
<h3>Model selection</h3>
<p>Once you have implemented above steps for the 3 models, you should
have a “best” fit for each one based on the tuning process. For each
best model you should have performance, uncertainty around the
performance measure, and some diagnostic plots. While for any real
research project, you likely want to look deeper (e.g. at uncertainty in
predictions instead of just overall performance), for now this is
enough. Pick one of the three models. Explain why you pick it. There is
no single answer that’s correct, I just want you to practice reasoning
for why you are doing something: in this case justify why you are
picking the model you do.</p>
</div>
<div id="final-evaluation" class="section level3">
<h3>Final evaluation</h3>
<p>Once you picked your final model, you are allowed to once –
<strong>and only once</strong> – fit it to the test data and check how
well it performs on that data. This gives you a somewhat honest estimate
of how the model might perform for new, unseen data. You can do that
using the <code>last_fit()</code> function applied to the model you end
up choosing. For the final model applied to the test set, report
performance and the diagnostic plots as above.</p>
<p>And that concludes what is likely a fairly long exercise. The code
itself is not that long, but it will take you time to cobble it together
from the <code>tidymodel</code> tutorial and possibly other sources.</p>
</div>
</div>
<div id="test-and-website-update" class="section level2">
<h2>Test and website update</h2>
<p>Make sure your analysis and all results are nicely documented and
everything runs/renders correctly. Then, add the newly created Quarto
document as an entry into your <code>_quarto.yml</code> file, as a
sub-menu of <code>Flu fitting</code>. Call it
<code>Machine Learning</code>. Recompile your portfolio website and make
sure everything works and shows up as expected. Then commit and
push.</p>
<p><strong>Since this is part of your portfolio site, you don’t need to
post anything, I know where to find it. Therefore there is no exercise
Slack channel for this module.</strong></p>
</div>
</div>
<div id="discussion" class="section level1">
<h1>Discussion</h1>
<p>Let’s use this week’s discussion to talk a bit more about the
projects. Last week you received feedback on our project from a few
classmates, this week I want everyone to have a chance to hear about and
comment on all projects.</p>
<p>To that end, post a summary description of your project to the
discussion channel. Briefly describe your data, your question(s), your
(planned) methods and (expected) results. Sort of like an abstract for a
paper. It doesn’t have to be very long, but should contain enough detail
that others can get the overall idea. This way, everyone can get a quick
glimpse as to what everyone else is doing. Also provide a link to the
repo for easy access (if your project is in a public repository. For
private repos, you can skip this).</p>
<p>Then, also mention specific questions/struggles/concerns you might
have regarding your project. It’s quite likely that there is some
overlap in approaches and questions among you and your classmates.
Hopefully, through this discussion you can provide each other with some
help and input.</p>
<p>Post this by Wednesday. Then read the summaries of your classmates’
projects. If you see a question/topic that you think you might be able
to help with, either by answering a specific question, or by providing
some general feedback, do so.</p>
<p>And of course, as you look at each others projects, it’s a 2-way
street. You can provide help/feedback, but you are also welcome to take
inspiration from what others are doing and integrate some of that into
your own project.</p>
<p>Since you get feedback from me at the other submission points, I plan
to largely stay out of this week’s discussion 😁. So this is all you
helping each other. Each of you has already seen a few projects and will
be reviewing 2 projects in a lot of depth at the end, but hopefully with
the discussion this week you get a bit of an idea of what everyone else
is doing, and you can provide feedback to others and earlier.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
