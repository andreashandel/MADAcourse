<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Andreas Handel">
<meta name="dcterms.date" content="2023-11-27">

<title>Tidyverse Exercise</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="Exercise_Tidyverse_files/libs/clipboard/clipboard.min.js"></script>
<script src="Exercise_Tidyverse_files/libs/quarto-html/quarto.js"></script>
<script src="Exercise_Tidyverse_files/libs/quarto-html/popper.min.js"></script>
<script src="Exercise_Tidyverse_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Exercise_Tidyverse_files/libs/quarto-html/anchor.min.js"></script>
<link href="Exercise_Tidyverse_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Exercise_Tidyverse_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Exercise_Tidyverse_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Exercise_Tidyverse_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Exercise_Tidyverse_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Tidyverse Exercise</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Andreas Handel </p>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            University of Georgia
          </p>
      </div>
    </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 27, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="overview" class="level1">
<h1>Overview</h1>
<p>You previously did a project where you used base R code to do a simple data analysis. We will revisit this analysis but now will be using R packages from the tidyverse and more.</p>
<p>We will use the Github workflow, with some additional features to learn a bit more about Github functionality.</p>
</section>
<section id="github-fork-and-pull" class="level1">
<h1>Github <em>fork and pull</em></h1>
<p>Previously, you learned how filing an <em>Issue</em> on Github can provide useful input and help improve projects. If you want to take things a step further, instead of <em>suggesting</em> a change/improvement, you could <em>just do it.</em> Github has a great feature for that, called <strong>pull requests</strong>. The basic idea is as follows. First, you make a copy of someone’s Github repository. In Github terminology, that is called doing a <em>fork</em> of their repository. You can then implement your improvements in the forked repository. Once you are done, you ask the owner of the original repository to incorporate the updates you made in the fork into their main/master repository. This last part is called issuing a <strong>pull request</strong>. You are requesting that the other person <em>pull</em> your changes into their repository, hence the at times confusing (at least for me) terminology. I prefer to think of them as <em>merge</em> requests or <em>sync</em> requests, i.e.&nbsp;you are requesting that they merge or sync your changes into their repository. You’ll find the terminology <em>merge request</em> is used at times. If the person who controls the main repository likes your changes, they will <em>merge</em> your fork into the main branch. And just like that, you have contributed to some project becoming better! We will practice this <em>fork and pull</em> flow below using a data cleaning and tidyverse coding project as an example.</p>
</section>
<section id="project-setup" class="level1">
<h1>Project setup</h1>
<ul>
<li>Find the <em>Class List</em> document on eLC, it’s in the <em>Documents</em> section. Note the name of the student who is <strong>above</strong> you (if you are the first student on the list, note the last student’s name).</li>
<li>Go to the <a href="https://github.com/epid8060fall2019">Github course organization</a> and find that student’s repository from the <em>R Coding</em> exercise (if you can’t figure out their Github username, email them).</li>
<li><strong>Fork</strong> their repository. You can think of a fork as a copy. See <a href="https://happygitwithr.com/fork-and-clone.html">this section of happygitwithR</a> for detailed instructions. You don’t need to follow Jenny’s workflow. Instead, click the <em>fork</em> button on Github, and fork it into your <strong>personal</strong> account. Then use Gitkraken to clone it to your computer.</li>
</ul>
</section>
<section id="data-wrangling-with-the-tidyverse" class="level1">
<h1>Data wrangling with the tidyverse</h1>
<ul>
<li>Once you have the fork of their repository on your local computer, open the project with RStudio. Run their R markdown file to make sure things work. You should be able to reproduce their initial analysis.</li>
<li>Now, let’s add more content. The original exercise was done using base R code that didn’t require any additional packages. We only loaded the <code>dslabs</code> package to get the data. While one can do a lot with base R, it is at times tedious to write code. Especially for data analysis tasks, there are many packages available that make our coding lives easier. We’ll use some now.</li>
<li>Write code to load the <code>tidyverse</code> collection of packages and the <code>skimr</code> package. If you don’t have them installed, do so. This will likely install a lot of packages and take a while.</li>
<li>Use the <code>glimpse</code> function from <code>dplyr</code> and the <code>skim</code> function from the <code>skimr</code> package to look at the <code>gapminder</code> object.</li>
<li>Use the <code>filter</code> and <code>select</code> functions from <code>dplyr</code> to extract only the African countries from the <code>gapminder</code> object and then keep only the variables <code>infant_mortality</code>, <code>life_expectancy</code>, <code>population</code> and <code>country</code>.</li>
<li>Make 2 plots using <code>ggplot</code> for life expectancy as a function of infant mortality and population. Also, give each country a separate color in the plot.</li>
<li>Write code that uses the gapminder object, pulls out data for Africa and year 2000 and creates a <code>ggplot</code> for <code>life_expectancy</code> as a function of <code>infant_mortality</code>, with a linear model fit added.</li>
</ul>
</section>
<section id="sending-updates-to-github" class="level1">
<h1>Sending updates to Github</h1>
<ul>
<li>Once you are done with your exercise, under the <code>Run</code> menu (top left) select <code>Restart R and Run all Chunks</code>. Make sure no error messages show up.</li>
<li>Under <code>Preview</code> do <code>knit to html</code>. You can also try a different output (pdf or word). Those files should now be in your project directory. Once you are happy with things, close RStudio.</li>
<li>Go to GitKraken. You should see a notification about changed files. Click <em>view changes</em>, then <em>Stage</em>. Write a commit message, commit the changes, then <em>Push</em> them. If things work, your local folder and the online repository should be at the same level. Your project is now online.</li>
</ul>
</section>
<section id="making-a-pull-request" class="level1">
<h1>Making a pull request</h1>
<ul>
<li>Now, let’s contribute your code to your classmate’s project. Go to the Github site for your repository. In the top left, you should see the <em>New Pull Request</em> button. (Underneath, it should say ’this branch is 1 commit ahead of <code>epid8060fall2019:master</code> - or, if you committed more than once, it could be N commits).</li>
<li>Click the <em>New Pull Request</em> button. A page comes up showing what you want to do, which is to send your changes to the original repository. You are requesting that the other person <em>pull</em> your changes into their repository. Hopefully, you’ll see a green check-mark that says <em>able to merge</em>. If your classmate made changes to the same files you did, it could have created a merge conflict. Hopefully, this won’t be the case.</li>
<li>In either case (merge conflict or not), you can click the green button and <em>Create a pull request</em>. You are presented with a box in which you want to add a meaningful title, so the other person knows what you changed and some more explanation in the box. Then click <em>Create pull request</em>.</li>
</ul>
</section>
<section id="checking-and-merging-pull-requests" class="level1">
<h1>Checking and merging pull requests</h1>
<ul>
<li>Once your classmate who has worked on your repository creates a pull request, you should receive a notification that a pull request was created. Go to the GitHub site and in the repository, click on <em>Pull requests</em>, then click on the request (there should only be one). Take a look. On the first page, it shows you their message and if there are conflicts with your version of the repository. Hopefully, you didn’t change things around while they did, so there shouldn’t be any conflicts. Click on the <em>Files changed</em> button, which will show you an overview of the code they changed. Removals are red, and the additions are green.</li>
<li>On the main pull request site, you can do various things. If you don’t like the suggested edits, you can write a comment and close the pull request without merging their changes into your repository. If you like most of what they did, but there is something they need to adjust, write a comment and let them know. Still, close the pull request and ask them to send a new one. If you are ok with their changes, you can merge the pull request and close it. Their updates are now part of your repository.</li>
<li>As a final check, open the repository on Gitkraken. You should see the <em>remote</em> ahead of your local copy. Do a <em>pull</em> to get the latest to your local computer. Then open the project in Rstudio and run the R markdown file to check that what they added works.</li>
</ul>
</section>
<section id="a-few-further-notes-on-github" class="level1">
<h1>A few further notes on Github</h1>
<ul>
<li>At times, you will get merge conflicts. At that stage, it gets a bit tricky. Gitkraken has a good tool to help you resolve conflicts, and it works well for text files (code, Rmd, md, etc.). It doesn’t work well for other files (word, Excel, etc.). Sometimes you have to temporarily move one of the conflicting files out of the repository, then do the merge, then manually see how the files changed and do the merge yourself.</li>
<li>To minimize conflicts, it is good practice to make multiple pull requests with small changes instead of a single large pull request. If you changed 20 files and 2 of them create a conflict, the person has to reject your complete pull request if they don’t want those conflicts. It is better to change a few files and work on just one topic, then issue a pull request. After that, start the next set, and issue another pull request. By breaking them up, it is more likely that conflicts are avoided or localized.</li>
<li>Some more information on <em>forks</em> and <em>pulls</em> and what to do if things don’t go right can be found in <a href="https://happygitwithr.com/">chapters 22, 26 (as of 8/14/19), of happygitwithR</a>. Note that a lot of the commands described as using on the command line (e.g.&nbsp;<code>stash</code>) can be applied graphically through Gitkraken.</li>
<li>Github also has <em>branches</em>. Those are similar to forks but meant for internal use. For instance, if you have a project and want to implement something new, but it might not work, you can create a branch, work in that branch, and once everything is ok, you can merge the branch into the main/master. This is useful if you write software that others are using, and you don’t want to break the whole thing. It is also helpful if you work with collaborators on a project. To be able to use branches, you need to be an owner or member of a repository. In contrast, you can fork any public repository.</li>
</ul>
</section>
<section id="another-fork-and-pull-exercise" class="level1">
<h1>Another <em>fork and pull</em> exercise</h1>
<p><em>This part of the exercise is optional.</em></p>
<ul>
<li>Help improve the course with your contributions! Find something wrong/unclear/worth improving with this course (e.g.&nbsp;a typo, something confusing, a broken link, a suggestion for a new reference, or anything else).</li>
<li>Go to the <a href="https://github.com/andreashandel/MADAcourse">Github repository for this course</a>.</li>
<li>Follow the exact steps above: Fork the course to your personal account, clone it to your local computer, implement your updates, push it back to Github, then initiate a pull request with the master.</li>
<li>I will get a notification of your pull request. If things look ok and no conflicts exist, I will merge your improvements into the course. And just like that, you have again contributed to improving this course!</li>
</ul>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>